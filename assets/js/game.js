window.game = {
	lua: function(cmd){
		console.log("RUNLUA: " + cmd)
	},

	close: function(){
		game.lua('ClosePhotonMenu()')
	},

	key_map: {
		1: "0",
		2: "1",
		3: "2",
		4: "3",
		5: "4",
		6: "5",
		7: "6",
		8: "7",
		9: "8",
		10: "9",
		11: "A",
		12: "B",
		13: "C",
		14: "D",
		15: "E",
		16: "F",
		17: "G",
		18: "H",
		19: "I",
		20: "J",
		21: "K",
		22: "L",
		23: "M",
		24: "N",
		25: "O",
		26: "P",
		27: "Q",
		28: "R",
		29: "S",
		30: "T",
		31: "U",
		32: "V",
		33: "W",
		34: "X",
		35: "Y",
		36: "Z",
		37: "0",
		38: "1",
		39: "2",
		40: "3",
		41: "4",
		42: "5",
		43: "6",
		44: "7",
		45: "8",
		46: "9",
		47: "/",
		48: "*",
		49: "-",
		50: "+",
		51: "ENTER",
		52: ".",
		53: "[",
		54: "]",
		55: ";",
		56: "'",
		57: "`",
		58: ",",
		59: ".",
		60: "/",
		61: "\\",
		62: "-",
		63: "=",
		64: "ENTER",
		65: "SPACE",
		66: "⌫",
		67: "⭾",
		68: "CAPS",
		69: "NUMLOCK",
		70: "ESC",
		71: "SCRL_LOCK",
		72: "INS",
		73: "DEL",
		74: "HOME",
		75: "END",
		76: "PGUP",
		77: "PGDN",
		78: "PAUSE",
		79: "SHIFT",
		80: "RSHIFT",
		81: "ALT",
		82: "RALT",
		83: "CTRL",
		84: "RCTRL",
		85: "LWIN",
		86: "RWIN",
		87: "APP",
		88: "↑",
		89: "←",
		90: "↓",
		91: "→",
		92: "F1",
		93: "F2",
		94: "F3",
		95: "F4",
		96: "F5",
		97: "F6",
		98: "F7",
		99: "F8",
		100: "F9",
		101: "F10",
		102: "F11",
		103: "F12",
		104: "CAPS_TOGGLE",
		105: "NUM_LOCK_TOGGLE",
		106: "SCROLL_TOGGLE",
		107: "LMB",
		108: "RMB",
		109: "M3",
		110: "M4",
		111: "M5",
		112: "SCROLL_UP",
		113: "SCROLL_DOWN",
		114: "JOY1",
		115: "JOY2",
		116: "JOY3",
		117: "JOY4",
		118: "JOY5",
		119: "JOY6",
		120: "JOY7",
		121: "JOY8",
		122: "JOY9",
		123: "JOY10",
		124: "JOY11",
		125: "JOY12",
		126: "JOY13",
		127: "JOY14",
		128: "JOY15",
		129: "JOY16",
		130: "JOY17",
		131: "JOY18",
		132: "JOY19",
		133: "JOY20",
		134: "JOY21",
		135: "JOY22",
		136: "JOY23",
		137: "JOY24",
		138: "JOY25",
		139: "JOY26",
		140: "JOY27",
		141: "JOY28",
		142: "JOY29",
		143: "JOY30",
		144: "JOY31",
		145: "JOY32",
		146: "JOY1",
		147: "JOY2",
		148: "JOY3",
		149: "JOY4",
		150: "JOY5",
		151: "JOY6",
		152: "JOY7",
		153: "JOY8",
		154: "JOY9",
		155: "JOY10",
		156: "JOY11",
		157: "JOY12",
		158: "JOY13",
		159: "JOY14",
	},

	get_key: function(command){
		game.lua('PhotonWebPage:QueueJavascript([[game.get_key_callback("' + command + '", ]] .. GetConVar("' + command + '"):GetInt() .. [[)]])')
	},

	get_key_callback: function(command, code){
		console.log("callback")
		console.log(command)
		console.log(String(code))
		if (code === "nil"){
			return
		}

		code = parseInt(code)
		console.log(code)
		$(`[data-bind="${command}"]`).each(function(_, element){
			element.innerText = game.key_map[code]
			$(element).attr('data-code', code)
		})
	}
}

$(document).ready(function(){
	$("[data-bind]").each(function(_, element){
		game.get_key(element.attributes['data-bind'].value)
	})
})
